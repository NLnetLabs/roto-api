# This matrix definition is used as both the package_build_rules and the package_test_rules Ploutos packaging
# workflow inputs.
---
pkg:
  - 'roto-api'
image:
  - "ubuntu:xenial"   # ubuntu/16.04
  - "ubuntu:bionic"   # ubuntu/18.04
  - "ubuntu:focal"    # ubuntu/20.04
  - "ubuntu:jammy"    # ubuntu/22.04
  - "debian:stretch"  # debian/9
  - "debian:buster"   # debian/10
  - "debian:bullseye" # debian/11
  - 'centos:7'
  - 'rockylinux:8'    # compatible with EOL centos:8
  - 'rockylinux:9'
target:
  - 'x86_64'
test-image:
  # Set 'test-image' to the empty string for all matrix permutations so that the default ('image') will be used
  # to launch an LXC container to test the created packages in. Why explicitly set what is already the default?
  # If this isn't present, later entries in the include set below will overwrite earlier entries that differ
  # only by their 'test-image' value. If however 'test-image' is present in the original matrix by defining it
  # here, then 'included' entries will no longer overwrite each other because they alter a key that is present
  # in the original matrix. This is just how GitHub Actions matrix include rules work.
  - ""
rpm_rpmlint_check_filters: "no-dependency-on" # to silence the "E: no-dependency-on locales-api" error for now
include:
  # the include entries below will not cause additional packages to be built because they specify combinations
  # of matrix keys and values as already exist elsewhere in the matrix, but they will cause an additional tests
  # to be run in the package testing phase, which will install the package in an LXC container running the 
  # specified 'test-image' instead of the 'image' it was built in.
  - pkg: 'roto-api'
    image: 'rockylinux:9'
    target: 'x86_64'
    test-image: 'almalinux:9'

  - pkg: 'roto-api'
    image: 'rockylinux:9'
    target: 'x86_64'
    test-image: 'centos:9-Stream'

# 'mode' is not used by the package building workflow job, but is used by the package testing workflow job.
# Ploutos will not include this key when using this matrix definition to generate package building matrix
# permutations but will use it when generating package testing permutations.
test-mode:   
  - 'fresh-install'
